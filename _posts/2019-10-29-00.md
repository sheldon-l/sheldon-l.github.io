---
layout: post
title: Linux 7 - Basic Operation For Debian-liked System
published_at: "2019-10-29"
updated_at: "2020-02-18"
author: Taners
tags: [Kali, Command Line, Hacker]
---

## Basic Command

### Get System Information

```bash
dmidecode
dmidecode -t [type No.]
```

### Working with Files and Directories

```bash
pwd
whoami  
cd <dir>
ls <-l/-a>     # long / all
<service> <--help/-h/-?>    # help

mkdir <newdir>
touch <newfile>
cat > <file>  # concatenate new content to a file, if file is already exist, old content will be cleaned
cp <oldfile> <newfile>  # copy
mv <oldfile> <newfile>  # rename or move
rm <file>               # remove file
rmdir <dir>             # remove empty dir
rm -rf <dir>             # remove all in dir, danger!
```

### Finding Files

```bash
locate <service>
whereis <service>
which <service>
<command> | grep <keyword> # filtering with keyword
find <dir> <options> <target>
```

### Install / Remove Packeges

```bash
sudo snap install <package>

sudo apt install <package>
sudo apt --fix-broken install <package>

sudo apt remove <package>  # remove package but keep configuration
sudo apt purge <package>   # remove package and configuration
sudo apt search <keyword>

sudo apt update
sudo apt update --fix-missing
sudo apt upgrade
sudo apt autoremove
sudo apt clean

sudo dpkg -i <package.deb>
sudo dpkg -l | grep <package>
sudo dpkg -r <package>
sudo dpkg --purge <package>
sudo dpkg --configure -a  # repair the dpkg database

# Old kernels:
# all kernel versions installed
sudo dpkg ––list | egrep –i ––color ‘linux-image|linux-headers’
# remove all old kernels
sudo apt-get ––purge autoremove

find . -name '*keyword*'
export Package_HOME=/usr/...
echo $Package_HOME
export PATH=$PATH:$Package_HOME/...
echo $PATH
which package
```

### Install / Remove Zipped Packeges

- Unzip
  - Readings: [How To Extract Zip, Gz, Tar, Bz2, 7z, Xz and Rar File in Linux](https://tecadmin.net/extract-archive-file-linux/)

```bash
unzip <filename.zip>
gunzip <filename.gz>
tar -xvf <filename.tar>
tar -xzvf <filename.tar.gz>
tar -xjvf <filename.tar.bz2>
tar -xJvf <filename.tar.xz>
tar -xf <fielname.tar.*>    # automatically detect
```

- make / bash

```bash
# make
cd <packageDir>
make <unload>
make <load>

# bash
bash <filename.sh>
```

## Network Scanning

### Checking

```bash
ping 12.34.56.78
traceroute 12.34.56.78
nmap 12.34.56.78

lsof -i -P -n

ifconfig  # active eth network
iwconfig  # active wireless network

netstat -r

arp -e

dig www.baidu.com
nslookup www.baidu.com

route
route add -net 10.10.10.0/24 gw 192.168.0.1
route del -net 10.10.10.0/24 gw 192.168.0.1
route add default gw 192.168.0.1

host www.google.com
host -t CNAME www.redhat.com

hostname

system-config-network
```

### Spoofing

``` bash
ifup <interface> # enable
ifdown <interface> # disable
ifconfig <interface> <private ip adress>  # reassignment your ip address, <interface> is some keyword like 'eth0' which can be checked by 'ifconfig'
ifconfig <interface> <private ip adress> netmask 255.255.0.0 broadcast 192.168.1.255  # reassignment a netmask of 255.255.0.0 and broadcast of 192.168.1.255
ifconfig <interface> hw <HardWareType> <newMAC> # <HardWareType> can be like 'ether'
```

### Return to DHCP-asigned IP

```bash
dhclient <interface>
```

### Manipulating the DNS

[DIG HOWTO](https://www.madboa.com/geek/dig/)

```bash
dig <adress>

# change DNS in /etc/resolv.conf
```

### Wi-Fi and Blutooth

- Security: WPA2PSK (Pre-Shared Key) > WPA (WiFi Protected Access) > WEP (Wired Equivalent Privacy)

```bash
ifconfig
iwconfig
iwevent
iwlist
iwspy
ifrename
iwgetid

# BlueZ tools
hciconfig
hcitool
hcidump
sdptool # scanning services
l2ping <MACadress> # once get MAC, we can do this
```

## File and Directories Permissions

- Types of Users:
  - root
  - groups: developers, network administrators, database 
administrators...
  - users
- Granting Permissions:
  - Permissions
    - r, 100, 4
    - w, 010, 2
    - x, 001, 1
  - Permissions order:
    - UGO: User|Group|Owner
    - note: Linux set permission `666`(file) and `777`(dir) as default after downloading
  - Mod:
    - remove permission: `-`
    - add permission: `+`
    - set permission: `=`
- Special Permissions:
  - Granting Temporary Root Permissions with SUID: enter a 4 before the regular permissions: `644 -> 4644`
  - Granting Temporary Root User's Permissions with SGID: enter a 2 before the regular permissions: `644 -> 2644`
  - The Outmoded Sticky Bit (Unix)

```bash
# root user need to create files/dir, install programs for other users, then change the owner ship or permission:
chown <user> <file/dir>
chgr <group> <service>

# check permissions
ls -l <file/dir>

# examples for changing permissions
chmod <u/g/o><-/+><w/r/x> <file>
chmod <467> <file>
chmod <4644/2644> <file>
```

## Process

- Nice Value: -10 ~ +19, the lower value the higher priority, only root user can renice a process to a negative value to give it higher priority.
- Zombie Process
- In Linux, whether working from shell or GUI, all process are in a shell
- Reconnaissance and Daemon

```bash
ps aux | grep <keyword> # running progress
lsof -i -P -n

# Setting the Priority when Starting Process 
nice -n <value> /bin/<someSlowProcess> # increament the nice value by <value>

# Changing the Priority of a Runing Process
renice <value> <PID>

# Killing Process
kill-<signal> PID
pkill -9 <service>

# Fore-Ground Process
fg <PID>

# Scheduling Process
crond     # run every day/week/month...
at        # run once at a future point
```

## SSH

```c
vim -r  // recover setting to zero.

ssh-keygen -t rsa -C your_email@domain.com  
// Press 'Enter' to save to defaul path
// Set Key: invisibal when input. 
// If don't input anything, the key is null.
// It is recommended to set key as null.
// Confirm Key.

cat ~/.ssh/id_rsa.pub 
// show your SSH key
```

### SSH and the Raspberrey Pi Spy

- [Raspbian](https://www.raspberrypi.org/downloads/raspbian/.)

- [Set Up Instruction](https://www.raspberrypi.org/learning/hardwareguide)

- Connect to a camera

```bash
ssh pi@IP
sudo raspi-config # to enable camera
```

## Data Base

### Information Extraction or Updating from MYSQL

- [Installation of MySQL on Linux](https://tane-rs.github.io/2019/09/14/01.html) both in Local and Server

kali>

```bash
service mysql start
```

mysql>

```sql
show databases; -- default database is already exist
-- information_schema (adm)
-- performance_schema (adm)
-- mysql (nonadm)

-- select 'mysql' for exp:
select <user>, <host>, <password> from mysql.user;

use mysql;
update user set password = "PASSWORD" where user = "root";
```

kali>

```bash
mysql -u root -p
```

### Accessing a Remote Database

kali>

```bash
mysql -u <username> -p <ipAdress>
```

mysql>

```sql
show databases;
select <user>, <host>, <password> from mysql.user;
```

## Proxy

```bash
proxychain <theCommandNeedProxied> <arguments>
# edit /etc/proxychain.conf
# find the 'ProxyList' section
# add proxies by entering the IP addresses and ports
# pay for proxies that can be trusted

export all_proxy="<null | protocol://ip:port>"
export http_proxy="<null | protocol://ip:port>"
export https_proxy="<null | protocol://ip:port>"

```

## Common Rules

- [An Introduction to Regular Expressions (Regex)](https://null-byte.wonderhowto.com/how-to/hack-like-pro-introduction-regular-expressions-regex-0150386/)

- [How to Read & Write Snort Rules to Evade an NIDS](https://null-byte.wonderhowto.com/how-to/hack-like-pro-read-write-snort-rules-evade-nids-network-intrusion-detection-system-0148215/)

---
